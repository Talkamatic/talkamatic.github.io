


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.2">
    
    
      
        <title>API for HTTP services - TDM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a2408e81.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#action-requests" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="TDM" class="md-header-nav__button md-logo" aria-label="TDM">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            TDM
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              API for HTTP services
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TDM" class="md-nav__button md-logo" aria-label="TDM">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    TDM
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../formalism/" title="Dialog Formalism" class="md-nav__link">
      Dialog Formalism
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../tutorial/" title="Step-by-step tutorial" class="md-nav__link">
      Step-by-step tutorial
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../rasa_nlu/" title="Using Rasa NLU" class="md-nav__link">
      Using Rasa NLU
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      APIs
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="APIs" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../http_frontend/" title="API for HTTP frontends" class="md-nav__link">
      API for HTTP frontends
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="API for HTTP services" class="md-nav__link md-nav__link--active">
      API for HTTP services
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <p>This document describes API version 1.1 for HTTP services. It needs to be implemented by services invoked by TDM over HTTP. Services are used by DDDs to invoke actions, invoke queries, recognize entities, and to validate parameters.</p>
<p>TDM invokes service methods with an HTTP request to the endpoint specified in <code>service_interface.xml</code>, using the POST method and a JSON body. It expects the status code to be 200 OK. (For other status codes, TDM reports an error to the user.)</p>
<p>The request body always contains a version number, specifying the version of the service integration format. The service can use the version in the request to validate that the service implementation is compatible with the request. The service also returns a version number in the response body, corresponding to the version of this API used when implementing the service. If the service returns a version number that is not compatible with the request, TDM reports an error to the user.</p>
<p>Responses from services adhere to the <a href="https://github.com/omniti-labs/jsend">JSend specification</a>. See <a href="#response-format">response format</a> for a general description.</p>
<p>The exact format of the request and the response depends on the service method and is described below.</p>
<h1 id="action-requests">Action requests</h1>
<p><strong>Request</strong></p>
<p>Below is an example of a request body for an action called <code>SetTemperature</code>, invoked when the user has requested to set the temperature to 23 degrees:</p>
<pre><code class="json">{
  &quot;version&quot;: &quot;1.1&quot;,
  &quot;session&quot;: {
    &quot;session_id&quot;: &quot;0000-abcd-1111-efgh&quot;
  },
  &quot;request&quot;: {
    &quot;type&quot;: &quot;action&quot;,
    &quot;name&quot;: &quot;SetTemperature&quot;,
    &quot;parameters&quot;: {
      &quot;degrees&quot;: {
        &quot;sort&quot;: &quot;integer&quot;,
        &quot;value&quot;: 23,
        &quot;grammar_entry&quot;: &quot;23&quot;
      }
    }
  },
  &quot;context&quot;: {
    &quot;active_ddd&quot;: &quot;MyDDD&quot;,
    &quot;facts&quot;: {
      &quot;degrees&quot;: {
        &quot;sort&quot;: &quot;integer&quot;,
        &quot;value&quot;: 23,
        &quot;grammar_entry&quot;: &quot;23&quot;
      }
    },
    &quot;language&quot;: &quot;eng&quot;,
    &quot;invocation_id&quot;: &quot;2222-ijkl-3333-mnop&quot;
  }
}
</code></pre>

<p>Format for <code>request</code>: see <a href="#request-object">Request object</a>.</p>
<p>Format for <code>session</code>: see <a href="#session-object">Session object</a>.</p>
<p>Format for <code>context</code>: see <a href="#context-object">Context object</a>.</p>
<p><strong>Response</strong></p>
<p>Actions invoked over HTTP can either succeed or fail with an expected reason. Below is the expected response body for the request above, when successful:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;
  }
}
</code></pre>

<p>Format for <code>status</code> and <code>data</code>: see <a href="#response-format">Response format</a>.</p>
<p>But say that someone tries to set the temperature of a refrigerator to 23 degrees, which is more than it can handle. If there's a failure reason <code>temperature_too_high</code> declared in <code>service_interface.xml</code>, the service can fail expectedly with:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;fail&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;,
    &quot;reason&quot;: &quot;temperature_too_high&quot;
  }
}
</code></pre>

<p>Format for <code>status</code> and <code>data</code>: see <a href="#response-format">Response format</a>.</p>
<p>The <code>data</code> object additionally contains these action specific members:</p>
<ul>
<li><code>reason</code> matching the failure that occurred. It needs to match one of the failure reasons declared for this action in <code>service_interface.xml</code>.</li>
</ul>
<h1 id="query-requests">Query requests</h1>
<p>Queries are invoked by TDM to retrieve information from a service, e.g. in order to be able to respond to a question from a user, or to fetch alternatives for alternative questions.</p>
<p><strong>Request</strong></p>
<p>Below is an example of a request body for a query called <code>current_temperature</code> with the parameter <code>location</code>, invoked when the user has asked for the temperature in London:</p>
<pre><code class="json">{
  &quot;version&quot;: &quot;1.1&quot;,
  &quot;session&quot;: {
    &quot;session_id&quot;: &quot;0000-abcd-1111-efgh&quot;
  },
  &quot;request&quot;: {
    &quot;type&quot;: &quot;query&quot;,
    &quot;name&quot;: &quot;current_temperature&quot;,
    &quot;parameters&quot;: {
      &quot;location&quot;: {
        &quot;sort&quot;: &quot;city&quot;,
        &quot;value&quot;: &quot;city_012345&quot;,
        &quot;grammar_entry&quot;: &quot;London&quot;
      }
    },
    &quot;min_results&quot;: 1,
    &quot;max_results&quot;: 1
  },
  &quot;context&quot;: {
    &quot;active_ddd&quot;: &quot;MyDDD&quot;,
    &quot;facts&quot;: {
      &quot;location&quot;: {
        &quot;sort&quot;: &quot;city&quot;,
        &quot;value&quot;: &quot;city_012345&quot;,
        &quot;grammar_entry&quot;: &quot;London&quot;
      }
    },
    &quot;language&quot;: &quot;eng&quot;,
    &quot;invocation_id&quot;: &quot;2222-ijkl-3333-mnop&quot;
  }
}
</code></pre>

<p>Format for <code>request</code>: see <a href="#request-object">Request object</a>.</p>
<p>The <code>request</code> object additionally contains these query specific members:</p>
<ul>
<li><code>min_results</code> specifies the minimum number of results that the service should return as a non-negative integer. If the service returns fewer results than specified by <code>min_results</code>, TDM reports an error to the user.</li>
<li><code>max_results</code> specifies the maximum number of results that the service should return. <code>max_results</code> is either a positive integer, or <code>null</code> meaning that there is no upper bound. If the service returns more results than specified by <code>max_results</code>, TDM reports an error to the user.</li>
</ul>
<p>Format for <code>session</code>: see <a href="#session-object">Session object</a>.</p>
<p>Format for <code>context</code>: see <a href="#context-object">Context object</a>.</p>
<p><strong>Response</strong></p>
<p>Below is an example of a response body for the request above, when the current temperature in London is 17 degrees:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;,
    &quot;result&quot;: [
      {
        &quot;value&quot;: 17,
        &quot;confidence&quot;: 1.0,
        &quot;grammar_entry&quot;: null
      }
    ]
  }
}
</code></pre>

<p>General format for responses: see <a href="#response-format">Response format</a>.</p>
<p><code>data</code> additionally contains these members specific to queries:</p>
<ul>
<li><code>result</code>: contains a list result items. Each result item is an object with the following members:<ul>
<li><code>value</code> can be either a number, string or <code>null</code>, depending on the query's predicate. For predicates of sort <code>integer</code> or <code>real</code>, a number is expected. For predicates of sort <code>datetime</code>, an ISO 8601 string is expected. For predicates of a custom sort, a string is expected, corresponding to the name of the individual. For dynamic sorts, the value <code>null</code> is supported, in which case a grammar entry is required.</li>
<li><code>confidence</code> should normally be set to 1.0. However, when the information is uncertain - e.g. when making a prediction from a user model - <code>confidence</code> can be set to a value from 0.0 to 1.0.</li>
<li><code>grammar_entry</code> can be set to specify a natural-language represention of the result. This is required for dynamic sorts, when <code>value</code> is <code>null</code>.</li>
</ul>
</li>
</ul>
<h2 id="additional-query-example-multiple-results">Additional query example: Multiple results</h2>
<p>Below is an example of a request and response for a query called <code>selected_contact</code> which is used to determine whether a single contact can be identified based on a first and last name. In the example, only the first name is known, and the service returns two matching contacts.</p>
<p>Request:</p>
<pre><code class="json">{
  &quot;version&quot;: &quot;1.1&quot;,
  &quot;session&quot;: {
    &quot;session_id&quot;: &quot;0000-abcd-1111-efgh&quot;
  },
  &quot;request&quot;: {
    &quot;type&quot;: &quot;query&quot;,
    &quot;name&quot;: &quot;selected_contact&quot;,
    &quot;parameters&quot;: {
      &quot;selected_first_name&quot;: {
        &quot;sort&quot;: &quot;first_name&quot;,
        &quot;value&quot;: &quot;fist_name_john&quot;,
        &quot;grammar_entry&quot;: &quot;John&quot;
      },
      &quot;selected_last_name&quot;: null
    },
    &quot;min_results&quot;: 0,
    &quot;max_results&quot;: null
  },
  &quot;context&quot;: {
    &quot;active_ddd&quot;: &quot;MyDDD&quot;,
    &quot;facts&quot;: {
      &quot;selected_first_name&quot;: {
        &quot;sort&quot;: &quot;first_name&quot;,
        &quot;value&quot;: &quot;fist_name_john&quot;,
        &quot;grammar_entry&quot;: &quot;John&quot;
      }
    },
    &quot;language&quot;: &quot;eng&quot;,
    &quot;invocation_id&quot;: &quot;2222-ijkl-3333-mnop&quot;
  }
}
</code></pre>

<p>Response:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;,
    &quot;result&quot;: [
      {
        &quot;value&quot;: &quot;contact_john_johnson&quot;,
        &quot;confidence&quot;: 1.0,
        &quot;grammar_entry&quot;: &quot;John Johnson&quot;
      },
      {
        &quot;value&quot;: &quot;contact_john_thompson&quot;,
        &quot;confidence&quot;: 1.0,
        &quot;grammar_entry&quot;: &quot;John Thompson&quot;
      }
    ]
  }
}
</code></pre>

<p>Also note that for this request example, the service may return an empty list of results if no matching contacts were found for the given parameters.</p>
<h1 id="entity-recognizer-requests">Entity recognizer requests</h1>
<p>Entity recognizers are invoked by TDM to identify entities in user utterances.</p>
<p><strong>Request</strong></p>
<p>Below is an example of a request body for an entity recognition invocation when the user has said "what is the temperature in London":</p>
<pre><code class="json">{
  &quot;version&quot;: &quot;1.1&quot;,
  &quot;session&quot;: {
    &quot;session_id&quot;: &quot;0000-abcd-1111-efgh&quot;
  },
  &quot;request&quot;: {
    &quot;type&quot;: &quot;entity_recognizer&quot;,
    &quot;name&quot;: &quot;LocationRecognizer&quot;,
    &quot;utterance&quot;: &quot;what is the temperature in London&quot;
  },
  &quot;context&quot;: {
    &quot;active_ddd&quot;: &quot;MyDDD&quot;,
    &quot;facts&quot;: {},
    &quot;language&quot;: &quot;eng&quot;,
    &quot;invocation_id&quot;: &quot;2222-ijkl-3333-mnop&quot;
  }
}
</code></pre>

<p>Format for <code>request</code>: see <a href="#request-object">Request object</a>.</p>
<p>The <code>request</code> object additionally contains these members specific to entity recognizers:</p>
<ul>
<li><code>utterance</code> is the user utterance that should be searched for entities. It's a string.</li>
</ul>
<p>Format for <code>session</code>: see <a href="#session-object">Session object</a>.</p>
<p>Format for <code>context</code>: see <a href="#context-object">Context object</a>.</p>
<p><strong>Response</strong></p>
<p>Below is an example of a response body for the request above:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;,
    &quot;result&quot;: [
      {
        &quot;grammar_entry&quot;: &quot;London&quot;,
        &quot;sort&quot;: &quot;city&quot;,
        &quot;value&quot;: &quot;city_012345&quot;
      }
    ]
  }
}
</code></pre>

<p>General format for responses: see <a href="#response-format">Response format</a>.</p>
<p><code>data</code> additionally contains these members specific to entity recognizers:</p>
<ul>
<li><code>result</code>: contains a list of zero or more result items. Each result item is an object with the following members:<ul>
<li><code>grammar_entry</code>: Natural-language representation of the recognized entity.</li>
<li><code>sort</code>: The entity's sort, corresponding to the sort's name in <code>ontology.xml</code>.</li>
<li><code>value</code>: ID or semantic representation of the entity if known, otherwise <code>null</code>. For static (non-dynamic) sorts, the <code>value</code> is mandatory and should correspond to the semantic name of an individual.</li>
</ul>
</li>
</ul>
<h1 id="validator-requests">Validator requests</h1>
<p>Validators are invoked by TDM to determine if information provided by the user is valid. If not, relevant feedback is given to the user.</p>
<p><strong>Request</strong></p>
<p>Below is an example of a request body for a validator called <code>RouteValidator</code> with the parameters <code>departure</code> and <code>destination</code>:</p>
<pre><code class="json">{
  &quot;version&quot;: &quot;1.1&quot;,
  &quot;session&quot;: {
    &quot;session_id&quot;: &quot;0000-abcd-1111-efgh&quot;
  },
  &quot;request&quot;: {
    &quot;type&quot;: &quot;validator&quot;,
    &quot;name&quot;: &quot;RouteValidator&quot;,
    &quot;parameters&quot;: {
      &quot;departure&quot;: {
        &quot;sort&quot;: &quot;city&quot;,
        &quot;value&quot;: &quot;city_012345&quot;,
        &quot;grammar_entry&quot;: &quot;London&quot;
      },
      &quot;destination&quot;: {
        &quot;sort&quot;: &quot;city&quot;,
        &quot;value&quot;: &quot;city_099998&quot;,
        &quot;grammar_entry&quot;: &quot;Chippinghirst&quot;
      }
    }
  },
  &quot;context&quot;: {
    &quot;active_ddd&quot;: &quot;MyDDD&quot;,
    &quot;facts&quot;: {
      &quot;departure&quot;: {
        &quot;sort&quot;: &quot;city&quot;,
        &quot;value&quot;: &quot;city_012345&quot;,
        &quot;grammar_entry&quot;: &quot;London&quot;
      },
      &quot;destination&quot;: {
        &quot;sort&quot;: &quot;city&quot;,
        &quot;value&quot;: &quot;city_099998&quot;,
        &quot;grammar_entry&quot;: &quot;Chippinghirst&quot;
      }
    },
    &quot;language&quot;: &quot;eng&quot;,
    &quot;invocation_id&quot;: &quot;2222-ijkl-3333-mnop&quot;
  }
}
</code></pre>

<p>Format for <code>request</code>: see <a href="#request-object">Request object</a>.</p>
<p>Format for <code>session</code>: see <a href="#session-object">Session object</a>.</p>
<p>Format for <code>context</code>: see <a href="#context-object">Context object</a>.</p>
<p><strong>Response</strong></p>
<p>Below is an example of a response body for the request above:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;,
    &quot;is_valid&quot;: false
  }
}
</code></pre>

<p>General format for responses: see <a href="#response-format">Response format</a>.</p>
<p><code>data</code> additionally contains these validator specific members:</p>
<ul>
<li><code>is_valid</code>: can be either <code>true</code> or <code>false</code>, specifying whether the combination of parameters is valid or not.</li>
</ul>
<h1 id="request-object">Request object</h1>
<p>In general, the <code>request</code> object contains the following members. It may also contain additional method specific members.</p>
<ul>
<li><code>type</code> is the method type, e.g. <code>action</code> or <code>query</code>. All methods that can be declared in <code>service_interface.xml</code> are supported. See examples for each of them above.</li>
<li><code>name</code> is the method name, as specified in <code>service_interface.xml</code>.</li>
<li><code>parameters</code> contains values for all parameters that are specified for the method in <code>service_interface.xml</code>. If a parameter is unknown, its value is <code>null</code>. Otherwise it's an object containing:<ul>
<li><code>sort</code>: ID of the predicate's sort as defined in the ontology.</li>
<li><code>value</code>: ID of the value. For the sorts <code>integer</code> and <code>real</code>, the ID is a number. For other sorts, e.g. <code>string</code>, <code>datetime</code> and custom sorts, the ID is a string.</li>
<li><code>grammar_entry</code>: Natural-language representation of the value.</li>
</ul>
</li>
</ul>
<p>Example:</p>
<pre><code class="json">{
  &quot;request&quot;: {
    &quot;type&quot;: &quot;validator&quot;,
    &quot;name&quot;: &quot;contact_validator&quot;,
    &quot;parameters&quot;: {
      &quot;selected_first_name&quot;: {
        &quot;sort&quot;: &quot;first_name&quot;,
        &quot;value&quot;: &quot;fist_name_john&quot;,
        &quot;grammar_entry&quot;: &quot;John&quot;
      },
      &quot;selected_last_name&quot;: null
    }
  }
}
</code></pre>

<h1 id="session-object">Session object</h1>
<p>The <code>session</code> object contains the following members:</p>
<ul>
<li><code>session_id</code>: String representing the current TDM session.</li>
</ul>
<p>Additionally, it contains the same data that was injected in the frontend request to TDM. This way, service calls can utilize frontend-specific session data. For more details, read about the session object <a href="../http_frontend/#session-object">in the frontend API docs</a></p>
<p>Example:</p>
<pre><code class="json">{
  &quot;session&quot;: {
    &quot;session_id&quot;: &quot;0000-abcd-1111-efgh&quot;,
    &quot;my_frontend&quot;: {
      &quot;user_id&quot;: &quot;123-abc-456-def&quot;,
      &quot;position&quot;: {
        &quot;latitude&quot;: &quot;57.699188&quot;,
        &quot;longitude&quot;: &quot;11.948313&quot;
      }
    }
  }
}
</code></pre>

<h1 id="context-object">Context object</h1>
<p>The <code>context</code> object contains the following members:</p>
<ul>
<li><code>active_ddd</code>: The name of the currently active DDD.</li>
<li><code>facts</code>: Information gathered during the conversation (see <a href="#facts-object">Facts object</a>).</li>
<li><code>language</code>: ID of the current language.</li>
<li><code>invocation_id</code>: A unique identifer for the invocation from TDM. This ID can be logged for analytics and issue reporting.</li>
</ul>
<h2 id="facts-object">Facts object</h2>
<p>The <code>facts</code> object contains a map of key-value pairs for information gathered during the conversation, e.g. from the user. The map may be empty.</p>
<p>The key is a string matching a predicate as defined in the ontology. The value is an object with the following members:</p>
<ul>
<li><code>sort</code>: ID of the predicate's sort as defined in the ontology.</li>
<li><code>value</code>: ID of the value. For the sorts <code>integer</code> and <code>real</code>, the ID is a number. For other sorts, e.g. <code>string</code>, <code>datetime</code> and custom sorts, the ID is a string.</li>
<li><code>grammar_entry</code>: Natural-language representation of the value.</li>
</ul>
<p>Example:</p>
<pre><code class="json">{
  &quot;facts&quot;: {
    &quot;departure&quot;: {
      &quot;sort&quot;: &quot;city&quot;,
      &quot;value&quot;: &quot;city_012345&quot;,
      &quot;grammar_entry&quot;: &quot;London&quot;
    },
    &quot;destination&quot;: {
      &quot;sort&quot;: &quot;city&quot;,
      &quot;value&quot;: &quot;city_012346&quot;,
      &quot;grammar_entry&quot;: &quot;Newcastle&quot;
    }
  }
}
</code></pre>

<h1 id="response-format">Response format</h1>
<p>All service responses adhere to the <a href="https://github.com/omniti-labs/jsend">JSend specification</a>.</p>
<p>In general, responses can have one of three appearances, corresponding to the status of the invocation: <code>success</code>, <code>fail</code> and <code>error</code>. See the examples below.</p>
<p>Success:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;
  }
}
</code></pre>

<p>Successful method invocations need to set their <code>status</code> to <code>success</code>.</p>
<p>The <code>data</code> object contains mostly method specific members. All methods need however include:</p>
<ul>
<li><code>version</code>: the version of the API used to process the request and format the response. If the version is not compatible with the request, TDM reports an error to the user.</li>
</ul>
<p>Fail:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;fail&quot;,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;
  }
}
</code></pre>

<p>Failures cannot be used with queries, entity recognizers or validators, but is supported by <a href="#action-requests">actions</a>. If a <code>fail</code> status is not supported or is reported unexpectedly, it is treated as an <code>error</code>. <code>error</code> is however preferred over <code>fail</code> since a helpful message can be provided. TDM will report the error to the user, but will not mention any details.</p>
<p>To report a failure, the <code>status</code> need to be set to <code>fail</code>.</p>
<p>The <code>data</code> object contains mostly method specific members. All methods need however include:</p>
<ul>
<li><code>version</code>: the version of the API used to process the request and format the response.</li>
</ul>
<p>Error:</p>
<pre><code class="json">{
  &quot;status&quot;: &quot;error&quot;,
  &quot;message&quot;: &quot;Could not communicate with the database.&quot;,
  &quot;code&quot;: 135,
  &quot;data&quot;: {
    &quot;version&quot;: &quot;1.1&quot;
  }
}
</code></pre>

<p>When a service encounters an error, i.e. an exception, the <code>status</code> need to be set to <code>error</code>. TDM will report the error to the user, but will not mention any details.</p>
<p><code>message</code> should be a human-readable message, explaining what went wrong. It will be logged but is not exposed to end-users.</p>
<p><code>code</code> (optional) is a numeric code identifying the error, if applicable.</p>
<p>The <code>data</code> needs to contain:</p>
<ul>
<li><code>version</code>: the version of the API used to process the request and format the response.</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../http_frontend/" title="API for HTTP frontends" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                API for HTTP frontends
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>